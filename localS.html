<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
<form>
    <input id="item" type="text" placeholder="New" required />
</form>
<h1></h1>
<h2>users</h2>
<ul></ul>




</body>
<script>
    userFind = false;
    const errorLog = document.querySelector('h1')
    const form = document.querySelector('form')
    const ul = document.querySelector('ul')
    const input = document.getElementById('item')
    let userArray = localStorage.getItem('user')
        ? JSON.parse(localStorage.getItem('user'))
        : []

    localStorage.setItem('user', JSON.stringify(userArray))
    const data = JSON.parse(localStorage.getItem('user'))

    const liMaker = (text) => {

        const li = document.createElement('li')
        li.textContent = 'psudo : '+ text.name + '  ;  score : ' +  text.score
        ul.appendChild(li)
    }

    form.addEventListener('submit', function (e) {
        e.preventDefault()
        let dataSimilar = JSON.parse(localStorage.getItem('user'))
        dataSimilar.forEach((item) => {
            if (input.value === item.name){
                userFind = true
                errorLog.innerText = 'LE PSUDO EXISTE'
                errorLog.style.color = 'red'
                console.log(item)
            }else {
                userFind = false
                errorLog.innerText = input.value + ' a bien été ajouté'
                errorLog.style.color = 'green'
            }

        })
        let objUser = {
            name : input.value,
            score : 0,
            password : 'password'
        }
        if (!userFind){
            userArray.push(objUser)
            localStorage.setItem('user', JSON.stringify(userArray))
            liMaker(objUser)
            input.value = ''
        }


    })

    data.forEach((item) => {
        liMaker(item)
    })

</script>
</html>
